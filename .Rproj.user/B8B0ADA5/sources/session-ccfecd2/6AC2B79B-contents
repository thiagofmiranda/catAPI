library('mirtCAT')
options(stringsAsFactors = FALSE)

# test pattern
set.seed(1)
pat <- generate_pattern(newmod, Theta = 0, df = newdf)

df <- data.frame(
  Questions = paste("Item",1:4,"?"),
  Answer = rep(1,4),
  Option.1 = rep(1,4),
  Option.2 = rep(0,4),
  Type = rep("radio",4)
  )

mirt_model = mirt(Abortion, itemtype = "2PL", SE = F,verbose = F)

pat <- generate_pattern(mirt_model, Theta = 0, df = df)
pat <- c("0","0","0","1")


CATdesign <- mirtCAT(mo = mirt_model, criteria = 'MI', design_elements = TRUE,  start_item = 2)
CATdesign$person$items_answered

CATdesign <- updateDesign(CATdesign, new_item = 2, new_response = 1)
CATdesign$person$items_answered
CATdesign$person$responses
CATdesign$person$thetas
ni <- findNextItem(CATdesign)

CATdesign <- updateDesign(CATdesign, new_item = ni, new_response = 1)
CATdesign$person$items_answered
CATdesign$person$responses
CATdesign$person$thetas
ni <- findNextItem(CATdesign)

CATdesign <- updateDesign(CATdesign, new_item = ni, new_response = 1)
CATdesign$person$items_answered
CATdesign$person$responses
CATdesign$person$thetas
ni <- findNextItem(CATdesign)

CATdesign <- updateDesign(CATdesign, new_item = ni, new_response = 1)
CATdesign$person$items_answered
CATdesign$person$responses
CATdesign$person$thetas

plot(CATdesign)




